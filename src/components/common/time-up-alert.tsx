"use client";

import React, { useState, useEffect, useRef } from "react";
import { Session } from "@/lib/types";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { Button } from "@/components/ui/button";
import { useSettings } from "@/hooks/use-settings";


interface TimeUpAlertProps {
  session: Session;
}

export function TimeUpAlert({ session }: TimeUpAlertProps) {
  const [showAlert, setShowAlert] = useState(false);
  const [hasBeenShown, setHasBeenShown] = useState(false);
  const audioRef = useRef<HTMLAudioElement | null>(null);
  const { settings } = useSettings();

  useEffect(() => {
    if (session.durationMinutes <= 0 || hasBeenShown) return;

    const checkTime = () => {
      const remainingMinutes =
        session.durationMinutes -
        (Date.now() - session.startTime) / (1000 * 60);
      
      if (remainingMinutes <= 0 && !hasBeenShown) {
        setShowAlert(true);
        setHasBeenShown(true); // Mencegah pemicu ulang
        
        if (settings.notificationsEnabled) {
          fetch("/api/push", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              action: 'send',
              payload: {
                title: "Waktu Habis!",
                body: `Sesi di ${session.tableName} telah selesai.`,
                icon: "/favicon.ico",
                tag: session.id,
                data: {
                  url: window.location.href, // Mengirim URL saat ini untuk fokus tab
                }
              }
            }),
          }).catch(console.error);
        }
      }
    };

    const interval = setInterval(checkTime, 1000);
    return () => clearInterval(interval);
  }, [session, hasBeenShown, settings.notificationsEnabled]);

  useEffect(() => {
    if (showAlert && audioRef.current) {
      audioRef.current.play().catch(console.error);
    }
  }, [showAlert]);
  
  if (!showAlert) {
    return null;
  }

  return (
    <>
      <audio ref={audioRef} preload="auto">
        <source src="data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjQ1LjEwMAAAAAAAAAAAAAAA//tAnxAAAAAAAAAAAAExAAAAAABkAAAAJAAAAAAAAAAAAAABZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAsAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAKAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAANAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAATAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAWAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAZAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAcAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAfAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAiAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAlAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAmAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAnAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAqAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAtAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAwAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAzAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA2AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA5AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA8AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAABAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAEAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAGAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAJAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAALAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAANAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAQAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAASAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAVAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAXAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAZAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAcAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAeAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAgAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAhAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAjAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAmAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAApAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAsAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAvAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAxAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA0AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA3AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA6AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA8AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA+AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAABAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAADAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAFAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAHAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAOAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAARAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAATAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAWAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAYAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAbAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAdAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAfAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAhAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAjAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAlAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAoAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAtAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAtAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAyAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA0AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA2AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA5AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA7AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA+AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAACAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAADAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAFAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAOAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAARAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAUAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAWAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAYAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAbAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAcAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAfAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAhAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAjAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAlAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAnAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAqAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAtAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAtAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAtAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAtAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAwAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAAzAAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA1AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA3AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA5AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA7AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA+AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2ZgAAAAAAAAAAAAAA//uwnxAAAAAAAAAAAAAAAAAAAAgAAAA/AAAAZGF2GAAA//uwnxEuALQAAAAAAAAAAAAAADSAAAAZE9MIQP4AAAAAAAAAAAAAAAAAAAAAAP/7UJ4SAAAMADSAAAAAR1MKVAAAAAAA//tQniQCwAsAP/+//4AAAAAAAAAAAAAAAAAAAAA//tQniQAAAAAABASwZDAAAAAAAAAAAAAAAAAAAAAAP/7UJ4kAwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4kAAAAAAAwE8GQwAAAAAAAAAAAAAAAAAAAAD/7UJ4jwwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4jAAAAsAAAE8GRwAAAAAAAAAAAAAAAAAAAAD/7UJ4jwwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4jAAAAAAAAG8GVAAAAAAAAAAAAAAAAAAAAAP/7UJ4iQwC/AD///38AAAAAAAAAAAAAAAAAAAAA//tQniLAAAAsAAACsGHQAAAAAAAAAAAAAAAAAAAAD/7UJ4jwwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4jAAAAAAAAI8GVAAAAAAAAAAAAAAAAAAAAAP/7UJ4jwwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4jAAAAAAAAI8GUAAAAAAAAAAAAAAAAAAAAAP/7UJ4iQwC/AD///38AAAAAAAAAAAAAAAAAAAAA//tQniKAAAAsAAADMGHQAAAAAAAAAAAAAAAAAAAAD/7UJ4jAwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4iAAAAAAAANsGUAAAAAAAAAAAAAAAAAAAAAP/7UJ4jAwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4eAAAAAAAAVsGUAAAAAAAAAAAAAAAAAAAAAP/7UJ4hgwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4eAAAAAAAAWMGUAAAAAAAAAAAAAAAAAAAAAP/7UJ4dwQC/AD///38AAAAAAAAAAAAAAAAAAAAA//tQnhzAAAAsAAABMGEwAAAAAAAAAAAAAAAAAAAAD/7UJ4eAwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4cAAAAAAAAYsGUAAAAAAAAAAAAAAAAAAAAAP/7UJ4eAwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4cAAAAAAAAY8GUAAAAAAAAAAAAAAAAAAAAAP/7UJ4bgQC/AD///38AAAAAAAAAAAAAAAAAAAAA//tQnhqAAAAsAAAAsGEwAAAAAAAAAAAAAAAAAAAAD/7UJ4cAwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7UJ4bAAAAAAAAbMGUAAAAAAAAAAAAAAAAAAAAAP/7UJ4cAwALAD//v/+AAAAAAAAAAAAAAAAAAAAAP/7" type="audio/mp3" />
      </audio>
      <AlertDialog open={showAlert} onOpenChange={setShowAlert}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle className="font-headline text-destructive text-2xl">
              Waktu Habis!
            </AlertDialogTitle>
            <AlertDialogDescription>
              Sesi di <strong>{session.tableName}</strong> telah selesai.
            </AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogAction onClick={() => setShowAlert(false)}>
            Mengerti
          </AlertDialogAction>
        </AlertDialogContent>
      </AlertDialog>
    </>
  );
}
